// main.js //
// Wszystko wrzucamy tu

jQuery(function($) {

  // = partials/collapse.js

  // Dropdown download button //
  // http://codepen.io/georgehastings/pen/vptdb
  $(".dropdown").on("click", function(event) {
    $(this).toggleClass("flip");
    event.stopPropagation();
  });
  $(document).on("click", function(event) {
    $(".dropdown").removeClass("flip");
  });

    function acts() {
      var te;
      var min = $('.post-list-item-content h2').height();
      $('.post-list-item .post-list-item-content h2').each(function() {
        if ($(this).height() < min)
          min = $(this).height();
      });
  
      $('.post-list-item-content h2').each(function() {
        if ($(this).height() == min) {
          te = $(this).parent().parent().children('.excerpt');
          $(te).text(function(index, currentText) {
            if (currentText.substr(currentText.length - 3) != '...')
              return currentText.substr(0, 150) + '...';
          });
        } else if (($(this).height() < (min - 1) * 3) && ($(this).height() > min)) {
          te = $(this).parent().parent().children('.excerpt');
          $(te).text(function(index, currentText) {
            return currentText.substr(0, 80) + '...';
          });
        } else {
          te = $(this).parent().parent().children('.excerpt');
          $(this).text(function(index, currentText) {
            if ((currentText.substr(currentText.length - 3) != '...') && (currentText.length > 120))
              return currentText.substr(0, 120) + '...';
          });
          te.css("display", "none");
        }
      });
    }
    acts();
    $(window).resize(acts);
  
  
  $(".card .excerpt").text(function(index, currentText) {
    return currentText.substr(0, 140) + '...';
  });

  // Pakuje mniejsze obrazki bez podpisu w <figure> //
  // Jeśli obrazek ma tytuł, tym się zajmuje php funkcja w project-functions.php
  $('.project-content p').each(function(index) {
    var some_img = $(this).find('img');
    var width = some_img.width();
    if (width < 980) {
      some_img.wrap("<figure></figure>");
    }
  });

  //Skraca imiona, by nie wychodziły za bloki
  $('.co-author h3 a').each(function(index) {
    var length = $(this).html().length;
    if (length > 13) {
      var name = $(this).text();
      // console.log(name);
      var trimmed_name = name.charAt(0) + ". " + name.substr(name.indexOf(' ') + 1);
      // console.log(trimmed_name);
      $(this).text(trimmed_name);
    }
  });

  // Notyfikacje, powiadomienia //
  $(".note-close").click(function() {
    $(this).parent()
      .animate({
        opacity: 0
      }, 250, function() {
        $(this)
          .animate({
            marginBottom: 0
          }, 250)
          .children()
          .animate({
            padding: 0
          }, 250)
          .wrapInner("<div />")
          .children()
          .slideUp(250, function() {
            $(this).closest(".note").remove();
          });
      });
  });

  // Animacje dla banera rekrutacji //
  $('label.button').on('click', function() {
    $('.fb').addClass('animated fadeInUp');
    $('.date .icon-container').addClass('animated slideInLeft');
    $('.date span').addClass('animated slideInLeft');
    $('.location .icon-container').addClass('animated slideInRight');
    $('.location span').addClass('animated slideInRight');
  
  });
  $('#close_banner').on('click', function() {
    $('.fb').removeClass('animated fadeInUp');
    $('.date .icon-container').removeClass('animated slideInLeft');
    $('.date span').removeClass('animated slideInLeft');
    $('.location .icon-container').removeClass('animated slideInRight');
    $('.location span').removeClass('animated slideInRight');
  });
  
  // http://stackoverflow.com/questions/24070627/create-dropdown-banner-when-user-first-visits-website
  // Pozwalają otwierać baner tylko przy pierwszej wizycie
  
  // cookie-js

  
    $(function() {
      // Touch ripple effect on buttons
      $('.button:not(.button.disabled)').on('click',
  
        function(e) {
  
          /*!
          SVG version for ripple effect via Jonathan Cutrell (gently modified)
          http://webdesign.tutsplus.com/tutorials/recreating-the-touch-ripple-effect-as-seen-on-google-design--cms-21655
          */
  
          var x = e.pageX;
          var y = e.pageY;
          var clickY = y - $(this).offset().top;
          var clickX = x - $(this).offset().left;
          var box = this;
  
          var setX = parseInt(clickX);
          var setY = parseInt(clickY);
          var ripple = '<svg class="ink"><circle cx="' + setX + '" cy="' + setY + '" r="' + 0 + '"></circle></svg>';
  
          $(this).find('.ink').remove();
          $(this).append(ripple);
  
          var c = $(box).find('circle');
          c.animate({
            'r': $(box).outerWidth()
          }, {
            duration: 333,
            step: function(val) {
              c.attr('r', val);
            },
            complete: function() {
              c.fadeOut('fast');
            }
          });
  
          return true;
  
        });
  
    });

  // Pobieranie nicków z url i wyświetlanie ich koło ikon społecznościowych
  // oraz wykorzystanie username'u githuba do wyświetlenia ostatnie aktywności
  $('.userinfo a').each(function(index) {
    var profile = $(this).attr('href');
    var github_profile = profile.substr(19);
    if (profile.indexOf('github') > -1) {
      $('a[data-github]').append(github_profile);
      Github.onlyuserActivity({
        username: github_profile,
        selector: ".github",
        limit: 10
      });
    }
    if (profile.indexOf('twitter') > -1) {
      $('a[data-twitter]').append(profile.substr(20));
    }
    if (profile.indexOf('facebook') > -1) {
      $('a[data-facebook]').append(profile.substr(25));
    }
  });
  
  // Github.onlyuserActivity({
  //   username: "synergia",
  //   selector: ".github_s",
  //   limit: 5
  // });


  $(function() {
    // set active radio to address bar
    $(document).on('click', '.tabs .tabs-nav label', function() {
      var hash = '#' + $(this).attr('for');
      window.history.replaceState('', '', hash);
    });
    // select active radio based on hash
    $(document.location.hash).prop('checked', true);
  });

  /* ========================================================================
   * Bootstrap: transition.js v3.3.6
   * http://getbootstrap.com/javascript/#transitions
   * ========================================================================
   * Copyright 2011-2015 Twitter, Inc.
   * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
   * ======================================================================== */
  
  
  +function ($) {
    'use strict';
  
    // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
    // ============================================================
  
    function transitionEnd() {
      var el = document.createElement('bootstrap')
  
      var transEndEventNames = {
        WebkitTransition : 'webkitTransitionEnd',
        MozTransition    : 'transitionend',
        OTransition      : 'oTransitionEnd otransitionend',
        transition       : 'transitionend'
      }
  
      for (var name in transEndEventNames) {
        if (el.style[name] !== undefined) {
          return { end: transEndEventNames[name] }
        }
      }
  
      return false // explicit for ie8 (  ._.)
    }
  
    // http://blog.alexmaccaw.com/css-transitions
    $.fn.emulateTransitionEnd = function (duration) {
      var called = false
      var $el = this
      $(this).one('bsTransitionEnd', function () { called = true })
      var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
      setTimeout(callback, duration)
      return this
    }
  
    $(function () {
      $.support.transition = transitionEnd()
  
      if (!$.support.transition) return
  
      $.event.special.bsTransitionEnd = {
        bindType: $.support.transition.end,
        delegateType: $.support.transition.end,
        handle: function (e) {
          if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
        }
      }
    })
  
  }(jQuery);

  $(document).ready(function(){
      $("#nav-mobile").html($("#nav-main").html());
      $("#nav-trigger .navicon-button").click(function(){
          if ($("nav#nav-mobile ul").hasClass("expanded")) {
              $("nav#nav-mobile ul.expanded").removeClass("expanded").slideUp(250);
              $(this).removeClass("open");
          } else {
              $("nav#nav-mobile ul").addClass("expanded").slideDown(250);
              $(this).addClass("open");
          }
      });
  });

  $("span").click(function(){
    $(this).toggleClass("open");
  });

  // Prezes zawsze na pierwszym miejscu //
  $('#management_board li#admin').insertBefore('#management_board li:eq(0)');
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJtYWluLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIG1haW4uanMgLy9cbi8vIFdzenlzdGtvIHdyenVjYW15IHR1XG5cbmpRdWVyeShmdW5jdGlvbigkKSB7XG5cbiAgLy8gPSBwYXJ0aWFscy9jb2xsYXBzZS5qc1xuXG4gIC8vIERyb3Bkb3duIGRvd25sb2FkIGJ1dHRvbiAvL1xuICAvLyBodHRwOi8vY29kZXBlbi5pby9nZW9yZ2VoYXN0aW5ncy9wZW4vdnB0ZGJcbiAgJChcIi5kcm9wZG93blwiKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgJCh0aGlzKS50b2dnbGVDbGFzcyhcImZsaXBcIik7XG4gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gIH0pO1xuICAkKGRvY3VtZW50KS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgJChcIi5kcm9wZG93blwiKS5yZW1vdmVDbGFzcyhcImZsaXBcIik7XG4gIH0pO1xuXG4gICAgZnVuY3Rpb24gYWN0cygpIHtcbiAgICAgIHZhciB0ZTtcbiAgICAgIHZhciBtaW4gPSAkKCcucG9zdC1saXN0LWl0ZW0tY29udGVudCBoMicpLmhlaWdodCgpO1xuICAgICAgJCgnLnBvc3QtbGlzdC1pdGVtIC5wb3N0LWxpc3QtaXRlbS1jb250ZW50IGgyJykuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCQodGhpcykuaGVpZ2h0KCkgPCBtaW4pXG4gICAgICAgICAgbWluID0gJCh0aGlzKS5oZWlnaHQoKTtcbiAgICAgIH0pO1xuICBcbiAgICAgICQoJy5wb3N0LWxpc3QtaXRlbS1jb250ZW50IGgyJykuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCQodGhpcykuaGVpZ2h0KCkgPT0gbWluKSB7XG4gICAgICAgICAgdGUgPSAkKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLmNoaWxkcmVuKCcuZXhjZXJwdCcpO1xuICAgICAgICAgICQodGUpLnRleHQoZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRUZXh0KSB7XG4gICAgICAgICAgICBpZiAoY3VycmVudFRleHQuc3Vic3RyKGN1cnJlbnRUZXh0Lmxlbmd0aCAtIDMpICE9ICcuLi4nKVxuICAgICAgICAgICAgICByZXR1cm4gY3VycmVudFRleHQuc3Vic3RyKDAsIDE1MCkgKyAnLi4uJztcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmICgoJCh0aGlzKS5oZWlnaHQoKSA8IChtaW4gLSAxKSAqIDMpICYmICgkKHRoaXMpLmhlaWdodCgpID4gbWluKSkge1xuICAgICAgICAgIHRlID0gJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5jaGlsZHJlbignLmV4Y2VycHQnKTtcbiAgICAgICAgICAkKHRlKS50ZXh0KGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50VGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnRUZXh0LnN1YnN0cigwLCA4MCkgKyAnLi4uJztcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0ZSA9ICQodGhpcykucGFyZW50KCkucGFyZW50KCkuY2hpbGRyZW4oJy5leGNlcnB0Jyk7XG4gICAgICAgICAgJCh0aGlzKS50ZXh0KGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50VGV4dCkge1xuICAgICAgICAgICAgaWYgKChjdXJyZW50VGV4dC5zdWJzdHIoY3VycmVudFRleHQubGVuZ3RoIC0gMykgIT0gJy4uLicpICYmIChjdXJyZW50VGV4dC5sZW5ndGggPiAxMjApKVxuICAgICAgICAgICAgICByZXR1cm4gY3VycmVudFRleHQuc3Vic3RyKDAsIDEyMCkgKyAnLi4uJztcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB0ZS5jc3MoXCJkaXNwbGF5XCIsIFwibm9uZVwiKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIGFjdHMoKTtcbiAgICAkKHdpbmRvdykucmVzaXplKGFjdHMpO1xuICBcbiAgXG4gICQoXCIuY2FyZCAuZXhjZXJwdFwiKS50ZXh0KGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50VGV4dCkge1xuICAgIHJldHVybiBjdXJyZW50VGV4dC5zdWJzdHIoMCwgMTQwKSArICcuLi4nO1xuICB9KTtcblxuICAvLyBQYWt1amUgbW5pZWpzemUgb2JyYXpraSBiZXogcG9kcGlzdSB3IDxmaWd1cmU+IC8vXG4gIC8vIEplxZtsaSBvYnJhemVrIG1hIHR5dHXFgiwgdHltIHNpxJkgemFqbXVqZSBwaHAgZnVua2NqYSB3IHByb2plY3QtZnVuY3Rpb25zLnBocFxuICAkKCcucHJvamVjdC1jb250ZW50IHAnKS5lYWNoKGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgdmFyIHNvbWVfaW1nID0gJCh0aGlzKS5maW5kKCdpbWcnKTtcbiAgICB2YXIgd2lkdGggPSBzb21lX2ltZy53aWR0aCgpO1xuICAgIGlmICh3aWR0aCA8IDk4MCkge1xuICAgICAgc29tZV9pbWcud3JhcChcIjxmaWd1cmU+PC9maWd1cmU+XCIpO1xuICAgIH1cbiAgfSk7XG5cbiAgLy9Ta3JhY2EgaW1pb25hLCBieSBuaWUgd3ljaG9kemnFgnkgemEgYmxva2lcbiAgJCgnLmNvLWF1dGhvciBoMyBhJykuZWFjaChmdW5jdGlvbihpbmRleCkge1xuICAgIHZhciBsZW5ndGggPSAkKHRoaXMpLmh0bWwoKS5sZW5ndGg7XG4gICAgaWYgKGxlbmd0aCA+IDEzKSB7XG4gICAgICB2YXIgbmFtZSA9ICQodGhpcykudGV4dCgpO1xuICAgICAgLy8gY29uc29sZS5sb2cobmFtZSk7XG4gICAgICB2YXIgdHJpbW1lZF9uYW1lID0gbmFtZS5jaGFyQXQoMCkgKyBcIi4gXCIgKyBuYW1lLnN1YnN0cihuYW1lLmluZGV4T2YoJyAnKSArIDEpO1xuICAgICAgLy8gY29uc29sZS5sb2codHJpbW1lZF9uYW1lKTtcbiAgICAgICQodGhpcykudGV4dCh0cmltbWVkX25hbWUpO1xuICAgIH1cbiAgfSk7XG5cbiAgLy8gTm90eWZpa2FjamUsIHBvd2lhZG9taWVuaWEgLy9cbiAgJChcIi5ub3RlLWNsb3NlXCIpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICQodGhpcykucGFyZW50KClcbiAgICAgIC5hbmltYXRlKHtcbiAgICAgICAgb3BhY2l0eTogMFxuICAgICAgfSwgMjUwLCBmdW5jdGlvbigpIHtcbiAgICAgICAgJCh0aGlzKVxuICAgICAgICAgIC5hbmltYXRlKHtcbiAgICAgICAgICAgIG1hcmdpbkJvdHRvbTogMFxuICAgICAgICAgIH0sIDI1MClcbiAgICAgICAgICAuY2hpbGRyZW4oKVxuICAgICAgICAgIC5hbmltYXRlKHtcbiAgICAgICAgICAgIHBhZGRpbmc6IDBcbiAgICAgICAgICB9LCAyNTApXG4gICAgICAgICAgLndyYXBJbm5lcihcIjxkaXYgLz5cIilcbiAgICAgICAgICAuY2hpbGRyZW4oKVxuICAgICAgICAgIC5zbGlkZVVwKDI1MCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkKHRoaXMpLmNsb3Nlc3QoXCIubm90ZVwiKS5yZW1vdmUoKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH0pO1xuICB9KTtcblxuICAvLyBBbmltYWNqZSBkbGEgYmFuZXJhIHJla3J1dGFjamkgLy9cbiAgJCgnbGFiZWwuYnV0dG9uJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgJCgnLmZiJykuYWRkQ2xhc3MoJ2FuaW1hdGVkIGZhZGVJblVwJyk7XG4gICAgJCgnLmRhdGUgLmljb24tY29udGFpbmVyJykuYWRkQ2xhc3MoJ2FuaW1hdGVkIHNsaWRlSW5MZWZ0Jyk7XG4gICAgJCgnLmRhdGUgc3BhbicpLmFkZENsYXNzKCdhbmltYXRlZCBzbGlkZUluTGVmdCcpO1xuICAgICQoJy5sb2NhdGlvbiAuaWNvbi1jb250YWluZXInKS5hZGRDbGFzcygnYW5pbWF0ZWQgc2xpZGVJblJpZ2h0Jyk7XG4gICAgJCgnLmxvY2F0aW9uIHNwYW4nKS5hZGRDbGFzcygnYW5pbWF0ZWQgc2xpZGVJblJpZ2h0Jyk7XG4gIFxuICB9KTtcbiAgJCgnI2Nsb3NlX2Jhbm5lcicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICQoJy5mYicpLnJlbW92ZUNsYXNzKCdhbmltYXRlZCBmYWRlSW5VcCcpO1xuICAgICQoJy5kYXRlIC5pY29uLWNvbnRhaW5lcicpLnJlbW92ZUNsYXNzKCdhbmltYXRlZCBzbGlkZUluTGVmdCcpO1xuICAgICQoJy5kYXRlIHNwYW4nKS5yZW1vdmVDbGFzcygnYW5pbWF0ZWQgc2xpZGVJbkxlZnQnKTtcbiAgICAkKCcubG9jYXRpb24gLmljb24tY29udGFpbmVyJykucmVtb3ZlQ2xhc3MoJ2FuaW1hdGVkIHNsaWRlSW5SaWdodCcpO1xuICAgICQoJy5sb2NhdGlvbiBzcGFuJykucmVtb3ZlQ2xhc3MoJ2FuaW1hdGVkIHNsaWRlSW5SaWdodCcpO1xuICB9KTtcbiAgXG4gIC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMjQwNzA2MjcvY3JlYXRlLWRyb3Bkb3duLWJhbm5lci13aGVuLXVzZXItZmlyc3QtdmlzaXRzLXdlYnNpdGVcbiAgLy8gUG96d2FsYWrEhSBvdHdpZXJhxIcgYmFuZXIgdHlsa28gcHJ6eSBwaWVyd3N6ZWogd2l6eWNpZVxuICBcbiAgLy8gY29va2llLWpzXG5cbiAgXG4gICAgJChmdW5jdGlvbigpIHtcbiAgICAgIC8vIFRvdWNoIHJpcHBsZSBlZmZlY3Qgb24gYnV0dG9uc1xuICAgICAgJCgnLmJ1dHRvbjpub3QoLmJ1dHRvbi5kaXNhYmxlZCknKS5vbignY2xpY2snLFxuICBcbiAgICAgICAgZnVuY3Rpb24oZSkge1xuICBcbiAgICAgICAgICAvKiFcbiAgICAgICAgICBTVkcgdmVyc2lvbiBmb3IgcmlwcGxlIGVmZmVjdCB2aWEgSm9uYXRoYW4gQ3V0cmVsbCAoZ2VudGx5IG1vZGlmaWVkKVxuICAgICAgICAgIGh0dHA6Ly93ZWJkZXNpZ24udHV0c3BsdXMuY29tL3R1dG9yaWFscy9yZWNyZWF0aW5nLXRoZS10b3VjaC1yaXBwbGUtZWZmZWN0LWFzLXNlZW4tb24tZ29vZ2xlLWRlc2lnbi0tY21zLTIxNjU1XG4gICAgICAgICAgKi9cbiAgXG4gICAgICAgICAgdmFyIHggPSBlLnBhZ2VYO1xuICAgICAgICAgIHZhciB5ID0gZS5wYWdlWTtcbiAgICAgICAgICB2YXIgY2xpY2tZID0geSAtICQodGhpcykub2Zmc2V0KCkudG9wO1xuICAgICAgICAgIHZhciBjbGlja1ggPSB4IC0gJCh0aGlzKS5vZmZzZXQoKS5sZWZ0O1xuICAgICAgICAgIHZhciBib3ggPSB0aGlzO1xuICBcbiAgICAgICAgICB2YXIgc2V0WCA9IHBhcnNlSW50KGNsaWNrWCk7XG4gICAgICAgICAgdmFyIHNldFkgPSBwYXJzZUludChjbGlja1kpO1xuICAgICAgICAgIHZhciByaXBwbGUgPSAnPHN2ZyBjbGFzcz1cImlua1wiPjxjaXJjbGUgY3g9XCInICsgc2V0WCArICdcIiBjeT1cIicgKyBzZXRZICsgJ1wiIHI9XCInICsgMCArICdcIj48L2NpcmNsZT48L3N2Zz4nO1xuICBcbiAgICAgICAgICAkKHRoaXMpLmZpbmQoJy5pbmsnKS5yZW1vdmUoKTtcbiAgICAgICAgICAkKHRoaXMpLmFwcGVuZChyaXBwbGUpO1xuICBcbiAgICAgICAgICB2YXIgYyA9ICQoYm94KS5maW5kKCdjaXJjbGUnKTtcbiAgICAgICAgICBjLmFuaW1hdGUoe1xuICAgICAgICAgICAgJ3InOiAkKGJveCkub3V0ZXJXaWR0aCgpXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZHVyYXRpb246IDMzMyxcbiAgICAgICAgICAgIHN0ZXA6IGZ1bmN0aW9uKHZhbCkge1xuICAgICAgICAgICAgICBjLmF0dHIoJ3InLCB2YWwpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNvbXBsZXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgYy5mYWRlT3V0KCdmYXN0Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gIFxuICAgICAgICAgIHJldHVybiB0cnVlO1xuICBcbiAgICAgICAgfSk7XG4gIFxuICAgIH0pO1xuXG4gIC8vIFBvYmllcmFuaWUgbmlja8OzdyB6IHVybCBpIHd5xZt3aWV0bGFuaWUgaWNoIGtvxYJvIGlrb24gc3BvxYJlY3pub8WbY2lvd3ljaFxuICAvLyBvcmF6IHd5a29yenlzdGFuaWUgdXNlcm5hbWUndSBnaXRodWJhIGRvIHd5xZt3aWV0bGVuaWEgb3N0YXRuaWUgYWt0eXdub8WbY2lcbiAgJCgnLnVzZXJpbmZvIGEnKS5lYWNoKGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgdmFyIHByb2ZpbGUgPSAkKHRoaXMpLmF0dHIoJ2hyZWYnKTtcbiAgICB2YXIgZ2l0aHViX3Byb2ZpbGUgPSBwcm9maWxlLnN1YnN0cigxOSk7XG4gICAgaWYgKHByb2ZpbGUuaW5kZXhPZignZ2l0aHViJykgPiAtMSkge1xuICAgICAgJCgnYVtkYXRhLWdpdGh1Yl0nKS5hcHBlbmQoZ2l0aHViX3Byb2ZpbGUpO1xuICAgICAgR2l0aHViLm9ubHl1c2VyQWN0aXZpdHkoe1xuICAgICAgICB1c2VybmFtZTogZ2l0aHViX3Byb2ZpbGUsXG4gICAgICAgIHNlbGVjdG9yOiBcIi5naXRodWJcIixcbiAgICAgICAgbGltaXQ6IDEwXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKHByb2ZpbGUuaW5kZXhPZigndHdpdHRlcicpID4gLTEpIHtcbiAgICAgICQoJ2FbZGF0YS10d2l0dGVyXScpLmFwcGVuZChwcm9maWxlLnN1YnN0cigyMCkpO1xuICAgIH1cbiAgICBpZiAocHJvZmlsZS5pbmRleE9mKCdmYWNlYm9vaycpID4gLTEpIHtcbiAgICAgICQoJ2FbZGF0YS1mYWNlYm9va10nKS5hcHBlbmQocHJvZmlsZS5zdWJzdHIoMjUpKTtcbiAgICB9XG4gIH0pO1xuICBcbiAgLy8gR2l0aHViLm9ubHl1c2VyQWN0aXZpdHkoe1xuICAvLyAgIHVzZXJuYW1lOiBcInN5bmVyZ2lhXCIsXG4gIC8vICAgc2VsZWN0b3I6IFwiLmdpdGh1Yl9zXCIsXG4gIC8vICAgbGltaXQ6IDVcbiAgLy8gfSk7XG5cblxuICAkKGZ1bmN0aW9uKCkge1xuICAgIC8vIHNldCBhY3RpdmUgcmFkaW8gdG8gYWRkcmVzcyBiYXJcbiAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLnRhYnMgLnRhYnMtbmF2IGxhYmVsJywgZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgaGFzaCA9ICcjJyArICQodGhpcykuYXR0cignZm9yJyk7XG4gICAgICB3aW5kb3cuaGlzdG9yeS5yZXBsYWNlU3RhdGUoJycsICcnLCBoYXNoKTtcbiAgICB9KTtcbiAgICAvLyBzZWxlY3QgYWN0aXZlIHJhZGlvIGJhc2VkIG9uIGhhc2hcbiAgICAkKGRvY3VtZW50LmxvY2F0aW9uLmhhc2gpLnByb3AoJ2NoZWNrZWQnLCB0cnVlKTtcbiAgfSk7XG5cbiAgLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAqIEJvb3RzdHJhcDogdHJhbnNpdGlvbi5qcyB2My4zLjZcbiAgICogaHR0cDovL2dldGJvb3RzdHJhcC5jb20vamF2YXNjcmlwdC8jdHJhbnNpdGlvbnNcbiAgICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAqIENvcHlyaWdodCAyMDExLTIwMTUgVHdpdHRlciwgSW5jLlxuICAgKiBMaWNlbnNlZCB1bmRlciBNSVQgKGh0dHBzOi8vZ2l0aHViLmNvbS90d2JzL2Jvb3RzdHJhcC9ibG9iL21hc3Rlci9MSUNFTlNFKVxuICAgKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cbiAgXG4gIFxuICArZnVuY3Rpb24gKCQpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gIFxuICAgIC8vIENTUyBUUkFOU0lUSU9OIFNVUFBPUlQgKFNob3V0b3V0OiBodHRwOi8vd3d3Lm1vZGVybml6ci5jb20vKVxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBcbiAgICBmdW5jdGlvbiB0cmFuc2l0aW9uRW5kKCkge1xuICAgICAgdmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYm9vdHN0cmFwJylcbiAgXG4gICAgICB2YXIgdHJhbnNFbmRFdmVudE5hbWVzID0ge1xuICAgICAgICBXZWJraXRUcmFuc2l0aW9uIDogJ3dlYmtpdFRyYW5zaXRpb25FbmQnLFxuICAgICAgICBNb3pUcmFuc2l0aW9uICAgIDogJ3RyYW5zaXRpb25lbmQnLFxuICAgICAgICBPVHJhbnNpdGlvbiAgICAgIDogJ29UcmFuc2l0aW9uRW5kIG90cmFuc2l0aW9uZW5kJyxcbiAgICAgICAgdHJhbnNpdGlvbiAgICAgICA6ICd0cmFuc2l0aW9uZW5kJ1xuICAgICAgfVxuICBcbiAgICAgIGZvciAodmFyIG5hbWUgaW4gdHJhbnNFbmRFdmVudE5hbWVzKSB7XG4gICAgICAgIGlmIChlbC5zdHlsZVtuYW1lXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgcmV0dXJuIHsgZW5kOiB0cmFuc0VuZEV2ZW50TmFtZXNbbmFtZV0gfVxuICAgICAgICB9XG4gICAgICB9XG4gIFxuICAgICAgcmV0dXJuIGZhbHNlIC8vIGV4cGxpY2l0IGZvciBpZTggKCAgLl8uKVxuICAgIH1cbiAgXG4gICAgLy8gaHR0cDovL2Jsb2cuYWxleG1hY2Nhdy5jb20vY3NzLXRyYW5zaXRpb25zXG4gICAgJC5mbi5lbXVsYXRlVHJhbnNpdGlvbkVuZCA9IGZ1bmN0aW9uIChkdXJhdGlvbikge1xuICAgICAgdmFyIGNhbGxlZCA9IGZhbHNlXG4gICAgICB2YXIgJGVsID0gdGhpc1xuICAgICAgJCh0aGlzKS5vbmUoJ2JzVHJhbnNpdGlvbkVuZCcsIGZ1bmN0aW9uICgpIHsgY2FsbGVkID0gdHJ1ZSB9KVxuICAgICAgdmFyIGNhbGxiYWNrID0gZnVuY3Rpb24gKCkgeyBpZiAoIWNhbGxlZCkgJCgkZWwpLnRyaWdnZXIoJC5zdXBwb3J0LnRyYW5zaXRpb24uZW5kKSB9XG4gICAgICBzZXRUaW1lb3V0KGNhbGxiYWNrLCBkdXJhdGlvbilcbiAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuICBcbiAgICAkKGZ1bmN0aW9uICgpIHtcbiAgICAgICQuc3VwcG9ydC50cmFuc2l0aW9uID0gdHJhbnNpdGlvbkVuZCgpXG4gIFxuICAgICAgaWYgKCEkLnN1cHBvcnQudHJhbnNpdGlvbikgcmV0dXJuXG4gIFxuICAgICAgJC5ldmVudC5zcGVjaWFsLmJzVHJhbnNpdGlvbkVuZCA9IHtcbiAgICAgICAgYmluZFR5cGU6ICQuc3VwcG9ydC50cmFuc2l0aW9uLmVuZCxcbiAgICAgICAgZGVsZWdhdGVUeXBlOiAkLnN1cHBvcnQudHJhbnNpdGlvbi5lbmQsXG4gICAgICAgIGhhbmRsZTogZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICBpZiAoJChlLnRhcmdldCkuaXModGhpcykpIHJldHVybiBlLmhhbmRsZU9iai5oYW5kbGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cylcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG4gIFxuICB9KGpRdWVyeSk7XG5cbiAgJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKXtcbiAgICAgICQoXCIjbmF2LW1vYmlsZVwiKS5odG1sKCQoXCIjbmF2LW1haW5cIikuaHRtbCgpKTtcbiAgICAgICQoXCIjbmF2LXRyaWdnZXIgLm5hdmljb24tYnV0dG9uXCIpLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgaWYgKCQoXCJuYXYjbmF2LW1vYmlsZSB1bFwiKS5oYXNDbGFzcyhcImV4cGFuZGVkXCIpKSB7XG4gICAgICAgICAgICAgICQoXCJuYXYjbmF2LW1vYmlsZSB1bC5leHBhbmRlZFwiKS5yZW1vdmVDbGFzcyhcImV4cGFuZGVkXCIpLnNsaWRlVXAoMjUwKTtcbiAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcyhcIm9wZW5cIik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgJChcIm5hdiNuYXYtbW9iaWxlIHVsXCIpLmFkZENsYXNzKFwiZXhwYW5kZWRcIikuc2xpZGVEb3duKDI1MCk7XG4gICAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoXCJvcGVuXCIpO1xuICAgICAgICAgIH1cbiAgICAgIH0pO1xuICB9KTtcblxuICAkKFwic3BhblwiKS5jbGljayhmdW5jdGlvbigpe1xuICAgICQodGhpcykudG9nZ2xlQ2xhc3MoXCJvcGVuXCIpO1xuICB9KTtcblxuICAvLyBQcmV6ZXMgemF3c3plIG5hIHBpZXJ3c3p5bSBtaWVqc2N1IC8vXG4gICQoJyNtYW5hZ2VtZW50X2JvYXJkIGxpI2FkbWluJykuaW5zZXJ0QmVmb3JlKCcjbWFuYWdlbWVudF9ib2FyZCBsaTplcSgwKScpO1xufSk7Il0sImZpbGUiOiJtYWluLm1pbi5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
